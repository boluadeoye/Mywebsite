<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Post — Boluadeoye</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,400;0,700;1,400&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
  :root {
    --bg: #0f172a;
    --panel: #111a2e;
    --panel-hover: #1a2441;
    --ink: #e5eefc;
    --muted: #94a3b8;
    --orange: #f59e0b;
    --orange-light: #fbbf24;
    --orange-ink: #0b0f19;
    --serif: 'Playfair Display', Georgia, 'Times New Roman', serif;
    --sans-serif: system-ui, -apple-system, 'Segoe UI', Roboto, Inter, Arial, sans-serif;
    --body-serif: 'Merriweather', serif;
    --transition: cubic-bezier(0.4, 0, 0.2, 1);
    --red: #f44336;
    --radius: 12px;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  html { background: var(--bg); scroll-behavior: smooth; }
  body {
    background: var(--bg);
    color: var(--ink);
    font: 18px/1.8 var(--body-serif);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    overflow-x: hidden;
    position: relative;
  }
  a { color: var(--orange); text-decoration: none; transition: all 0.3s var(--transition); }
  a:hover { color: var(--orange-light); text-decoration: underline; text-underline-offset: 4px; }
  .wrap { margin: 0 auto; max-width: 1000px; padding: 0 1.5rem; position: relative; z-index: 1; }

  /* Main Header */
  header {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(15, 23, 42, 0.95);
    backdrop-filter: blur(8px);
    border-bottom: 1px solid rgba(245, 158, 11, 0.2);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
  }
  .header-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    min-height: 70px;
    padding: 0 1rem;
  }
  .brand {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0;
    position: absolute;
    left: 50%;
    top: -20px;
    transform: translateX(-50%);
  }
  .brand-logo {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    transition: transform 0.4s var(--transition);
    margin-bottom: -25px;
  }
  .brand:hover .brand-logo { transform: scale(1.05); }
  .brand h1 {
    font-family: var(--serif);
    font-size: 1.4rem;
    font-weight: 800;
    line-height: 1;
    letter-spacing: -0.5px;
    color: var(--ink);
  }
  .top-nav { display: none; gap: 0.5rem; align-items: center; margin-left: auto; flex-wrap: wrap; }
  .top-nav a {
    padding: 0.5rem 1rem;
    border-radius: 999px;
    font-weight: 600;
    font-size: 0.9rem;
    border: 1px solid transparent;
  }
  .top-nav a:hover, .top-nav a.active {
    color: var(--orange);
    border-color: var(--orange);
    background: rgba(245, 158, 11, 0.1);
  }
  .hamburger {
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(245, 158, 11, 0.2);
    color: var(--ink);
    cursor: pointer;
    transition: all 0.3s ease;
  }
  .hamburger:hover { background: rgba(245, 158, 11, 0.15); }
  .hamburger svg { width: 22px; height: 22px; }
  .side-menu {
    position: fixed;
    top: 0;
    left: -260px;
    z-index: 200;
    width: 240px;
    height: 100%;
    padding: 2rem 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    background: var(--panel);
    border-right: 1px solid rgba(245, 158, 11, 0.2);
    transition: left 0.3s var(--transition);
  }
  .side-menu.active { left: 0; }
  .side-menu a {
    padding: 1rem 1.25rem;
    border-radius: 8px;
    font-weight: 600;
    font-size: 0.95rem;
    border: 1px solid transparent;
  }
  .side-menu a:hover, .side-menu a.active {
    background: rgba(245, 158, 11, 0.1);
    border-color: var(--orange);
    color: var(--orange);
  }
  .overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    z-index: 150;
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  .overlay.show { display: block; opacity: 1; }
  @media (min-width: 880px) { .top-nav { display: flex; } .hamburger { display: none; } }

  /* Progress Bar */
  #progress-bar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--orange), var(--orange-light));
    width: 0;
    z-index: 201;
    transition: width 0.3s var(--transition);
  }

  /* Feature Cover */
  .feature-cover {
    position: relative;
    padding: 4rem 0 5rem;
    background: linear-gradient(to bottom, rgba(15, 23, 42, 0.9), var(--bg));
    text-align: center;
    overflow: hidden;
  }
  .feature-cover-bg {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 1;
    filter: brightness(0.6) blur(2px);
    transition: transform 0.5s var(--transition);
  }
  .feature-cover::after {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 2;
    background: linear-gradient(to bottom, rgba(15, 23, 42, 0.5), rgba(15, 23, 42, 0.8));
  }
  .post-header {
    position: relative;
    z-index: 3;
    max-width: 700px;
    margin: 0 auto;
    color: var(--ink);
    animation: fadeInUp 0.8s var(--transition);
  }
  .post-title {
    font-family: var(--serif);
    font-size: clamp(2.25rem, 4.5vw, 3.25rem);
    font-weight: 800;
    line-height: 1.2;
    margin-bottom: 1.5rem;
    text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  }
  .post-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    justify-content: center;
    font-family: var(--sans-serif);
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--muted);
    background: rgba(255, 255, 255, 0.05);
    padding: 0.75rem 1.5rem;
    border-radius: 999px;
    border: 1px solid rgba(245, 158, 11, 0.2);
  }
  .post-meta span {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  .begin-reading-btn {
    margin-top: 2rem;
    padding: 0.75rem 2rem;
    background: linear-gradient(135deg, var(--orange), var(--orange-light));
    color: var(--orange-ink);
    font-family: var(--sans-serif);
    font-weight: 700;
    font-size: 0.95rem;
    border-radius: 999px;
    border: none;
    cursor: pointer;
    transition: all 0.3s var(--transition);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  .begin-reading-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(245, 158, 11, 0.3);
  }
  @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

  /* Main Content Area */
  .main-content-area {
    display: grid;
    grid-template-columns: 1fr;
    gap: 2rem;
    padding: 2.5rem 0;
    max-width: 700px;
    margin: 0 auto;
  }
  .mode-paginated .main-content-area { display: none; }
  .main-content-area.visible { display: grid; }
  @media (min-width: 1024px) {
    .main-content-area { grid-template-columns: 200px 1fr; }
  }
  .toc-sidebar {
    position: sticky;
    top: 90px;
    align-self: start;
    padding: 1.5rem;
    background: var(--panel);
    border-radius: var(--radius);
    border: 1px solid rgba(245, 158, 11, 0.15);
    font-family: var(--sans-serif);
    font-size: 0.9rem;
    color: var(--muted);
  }
  .toc-sidebar h3 {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--ink);
    margin-bottom: 1rem;
  }
  .toc-sidebar ul { list-style: none; }
  .toc-sidebar a {
    display: block;
    padding: 0.5rem 0;
    color: var(--muted);
  }
  .toc-sidebar a:hover, .toc-sidebar li.active a { color: var(--orange); }

  /* Post Content */
  .post-content-wrapper {
    max-width: 700px;
    margin: 0 auto;
    padding: 0 1.5rem;
  }
  .post-content {
    font-family: var(--body-serif);
    font-size: 1.15rem;
    line-height: 1.85;
    color: var(--ink);
    background: var(--panel);
    padding: 2rem;
    border-radius: var(--radius);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
  }
  .post-content h1 {
    font-family: var(--serif);
    font-size: 2.25rem;
    font-weight: 800;
    line-height: 1.2;
    color: var(--ink);
    margin: 2rem 0 1.25rem;
    text-align: center;
  }
  .post-content h2 {
    font-family: var(--serif);
    font-size: 1.75rem;
    font-weight: 700;
    line-height: 1.3;
    color: var(--ink);
    margin: 1.75rem 0 1rem;
    padding-left: 0.75rem;
    border-left: 3px solid var(--orange);
  }
  .post-content h3 {
    font-family: var(--sans-serif);
    font-size: 1.35rem;
    font-weight: 600;
    line-height: 1.4;
    color: var(--ink);
    margin: 1.5rem 0 0.75rem;
  }
  .post-content p {
    margin-bottom: 1.5rem;
    color: var(--ink);
  }
  .post-content a {
    color: var(--orange);
    text-decoration: underline;
    text-underline-offset: 4px;
  }
  .post-content a:hover { color: var(--orange-light); }
  .post-content blockquote {
    font-family: var(--body-serif);
    font-style: italic;
    font-size: 1.2rem;
    color: var(--muted);
    margin: 2rem 1rem;
    padding: 1.25rem 1.5rem;
    background: rgba(245, 158, 11, 0.05);
    border-left: 3px solid var(--orange);
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
  .post-content ul, .post-content ol {
    margin: 1.5rem 0;
    padding-left: 2rem;
  }
  .post-content li {
    margin-bottom: 0.75rem;
    color: var(--ink);
  }
  .post-content hr {
    border: none;
    height: 1px;
    background: linear-gradient(to right, transparent, rgba(245, 158, 11, 0.3), transparent);
    margin: 2.5rem 0;
  }
  .post-content code {
    font-family: 'SF Mono', 'Menlo', monospace;
    font-size: 0.95rem;
    background: var(--panel-hover);
    padding: 0.2rem 0.4rem;
    border-radius: 4px;
    color: var(--orange-light);
  }
  .post-content pre {
    background: var(--panel-hover);
    padding: 1.25rem;
    border-radius: 8px;
    overflow-x: auto;
    margin: 1.5rem 0;
    border: 1px solid rgba(245, 158, 11, 0.15);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
  .post-content pre code {
    background: none;
    padding: 0;
  }
  .post-content img {
    max-width: 100%;
    height: auto;
    display: block;
    margin: 2rem auto;
    border-radius: 8px;
    border: 1px solid rgba(245, 158, 11, 0.15);
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
  }
  .post-type-essay .post-content {
    background: var(--panel);
    padding: 2rem;
    line-height: 1.8;
  }

  /* Page Navigation */
  .page-navigation {
    max-width: 700px;
    margin: 2rem auto 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-family: var(--sans-serif);
  }
  .page-indicator {
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--muted);
  }
  .epilogue-page {
    text-align: center;
    padding: 2.5rem 2rem;
    background: var(--panel);
    border-radius: var(--radius);
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
  }
  .epilogue-page h2 {
    font-family: var(--serif);
    font-size: 1.8rem;
    margin-bottom: 1.25rem;
  }
  .article-ender {
    border: none;
    height: 1px;
    background: linear-gradient(to right, transparent, var(--orange), transparent);
    margin: 2.5rem auto;
    max-width: 700px;
  }
  .post-nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
    padding: 2rem 0;
    max-width: 700px;
    margin: 0 auto;
    flex-wrap: wrap;
  }
  .btn-chip {
    padding: 0.75rem 1.5rem;
    background: transparent;
    color: var(--orange);
    border: 2px solid var(--orange);
    border-radius: 999px;
    font-family: var(--sans-serif);
    font-weight: 600;
    font-size: 0.9rem;
    transition: all 0.3s var(--transition);
    cursor: pointer;
  }
  .btn-chip:hover {
    background: var(--orange);
    color: var(--orange-ink);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
  }
  .btn-chip:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  .mode-toggle {
    position: absolute;
    top: 1rem;
    right: 1rem;
    z-index: 5;
  }

  /* Loading and Error States */
  .loading-container, .error-container {
    min-height: 250px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    background: var(--panel);
    border-radius: var(--radius);
    color: var(--muted);
    padding: 2rem;
  }
  .loading-spinner {
    width: 36px;
    height: 36px;
    border: 3px solid rgba(245, 158, 11, 0.3);
    border-top-color: var(--orange);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 1rem;
  }
  @keyframes spin { to { transform: rotate(360deg); } }
  .error-container h2 {
    font-family: var(--serif);
    font-size: 1.6rem;
    color: var(--red);
    margin-bottom: 1rem;
  }

  /* Related Posts */
  #disqus_thread, #related-posts-container {
    max-width: 700px;
    margin: 2.5rem auto;
    padding-top: 1.5rem;
    border-top: 1px solid rgba(245, 158, 11, 0.2);
  }
  .related-posts-title {
    font-family: var(--serif);
    font-size: 1.6rem;
    font-weight: 800;
    color: var(--ink);
    text-align: center;
    margin-bottom: 1.5rem;
  }
  .related-posts-grid {
    display: grid;
    gap: 1.5rem;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  }
  .related-post-card {
    background: var(--panel);
    border-radius: var(--radius);
    border: 1px solid rgba(245, 158, 11, 0.15);
    overflow: hidden;
    transition: all 0.3s var(--transition);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
  .related-post-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
    border-color: var(--orange);
  }
  .related-post-card .cover {
    height: 150px;
    overflow: hidden;
    background: var(--panel-hover);
  }
  .related-post-card .cover img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.4s var(--transition);
  }
  .related-post-card:hover .cover img { transform: scale(1.05); }
  .related-post-card .content {
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  .related-post-card h4 {
    font-family: var(--sans-serif);
    font-size: 1.05rem;
    font-weight: 600;
    color: var(--ink);
    line-height: 1.4;
  }
  .related-post-card p {
    font-size: 0.85rem;
    color: var(--muted);
    line-height: 1.6;
  }
  .related-post-card.no-content { display: none; }

  /* Footer */
  footer {
    background: var(--panel);
    padding: 1.5rem 0;
    margin-top: 3rem;
    border-top: 1px solid rgba(245, 158, 11, 0.2);
  }
  footer p {
    font-family: var(--sans-serif);
    font-size: 0.9rem;
    color: var(--muted);
    text-align: center;
  }
  </style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WJVVQDCS32"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-WJVVQDCS32');
</script>
</head>
<body>
  <div id="progress-bar"></div>

  <nav id="sideMenu" class="side-menu">
    <a href="./">Home</a>
    <a href="./posts.html">All Posts</a>
    <a href="./library.html">Library</a>
    <a href="./about.html">About</a>
  </nav>
  <div id="menuOverlay" class="overlay"></div>

  <header id="header">
    <div class="wrap header-row">
      <button id="menuBtn" class="hamburger" aria-label="Open menu" aria-expanded="false">
        <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><rect x="4" y="6" width="16" height="2" rx="1"/><rect x="4" y="11" width="16" height="2" rx="1"/><rect x="4" y="16" width="16" height="2" rx="1"/></svg>
      </button>
      <a class="brand" href="./">
        <img src="images/Logo.png" alt="Boluadeoye Logo" width="80" height="80" class="brand-logo">
        <h1>Boluadeoye</h1>
      </a>
      <nav class="top-nav" aria-label="Primary Navigation">
        <a href="./">Home</a>
        <a href="./posts.html">All Posts</a>
        <a href="./library.html">Library</a>
        <a href="./about.html">About</a>
      </nav>
    </div>
  </header>

  <main id="post-page-container">
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p>Loading your article...</p>
    </div>
  </main>

  <footer>
    <div class="wrap"><p>© 2025 Boluadeoye • Crafted with passion</p></div>
  </footer>

  <script>
  (function(){
    // --- STATE MANAGEMENT ---
    const state = {
      allPosts: [], postData: null,
      pages: [], currentPage: 1, file: null, mode: 'simple',
      wordCount: 0, totalPages: 0
    };

    // --- DOM ELEMENTS & CONSTANTS ---
    const menuBtn = document.getElementById('menuBtn');
    const sideMenu = document.getElementById('sideMenu');
    const menuOverlay = document.getElementById('menuOverlay');
    const progressBar = document.getElementById('progress-bar');
    const pageContainer = document.getElementById('post-page-container');
    const WORD_COUNT_THRESHOLD = 1500;
    const PAGE_SEPARATOR = /\n---\s*page\s*---\n/;

    // --- GLOBAL FUNCTIONS ---
    window.sharePost = function() {
      if(state.postData && navigator.share) {
        navigator.share({ title: state.postData.title, text: state.postData.excerpt, url: window.location.href });
      } else if (state.postData) {
        const text = encodeURIComponent(`Check out: "${state.postData.title}" ${window.location.href}`);
        window.open('https://api.whatsapp.com/send?text=' + text, '_blank');
      }
    };

    // --- HELPER FUNCTIONS ---
    function getWordCount(text) { return text.trim().split(/\s+/).length; }

    function createSEOTags() {
      document.querySelectorAll('link[rel="next"], link[rel="prev"], link[rel="canonical"]').forEach(tag => tag.remove());
      const head = document.head;
      const canonicalUrl = `${window.location.origin}${window.location.pathname}?file=${encodeURIComponent(state.file)}`;
      const canonicalTag = document.createElement('link');
      canonicalTag.rel = 'canonical';
      canonicalTag.href = canonicalUrl;
      head.appendChild(canonicalTag);

      if (state.mode === 'paginated') {
        if (state.currentPage < state.totalPages) {
          const nextTag = document.createElement('link');
          nextTag.rel = 'next';
          nextTag.href = `${canonicalUrl}&page=${state.currentPage + 1}`;
          head.appendChild(nextTag);
        }
        if (state.currentPage > 1) {
          const prevTag = document.createElement('link');
          prevTag.rel = 'prev';
          prevTag.href = `${canonicalUrl}&page=${state.currentPage - 1}`;
          head.appendChild(prevTag);
        }
      }
    }

    // --- RENDER & LOGIC FUNCTIONS ---
    function renderPage(pageNumber) {
      if (pageNumber < 1) return;
      state.currentPage = pageNumber;

      const url = new URL(window.location);
      url.searchParams.set('page', state.currentPage);
      window.history.replaceState({page: state.currentPage}, '', url);

      const contentEl = document.getElementById('article-content');
      if (!contentEl) return;

      contentEl.style.opacity = 0;
      setTimeout(() => {
        if (state.currentPage > state.totalPages) {
          contentEl.innerHTML = `<div class="epilogue-page"><h2>Thank you for reading</h2><p>Your time and attention are deeply appreciated. If this story resonated with you, please consider sharing it or leaving your thoughts below.</p></div>`;
          document.getElementById('related-posts-container').style.display = 'block';
          document.getElementById('disqus_thread').style.display = 'block';
          loadDisqus(state.file);
        } else {
          contentEl.innerHTML = marked.parse(state.pages[state.currentPage - 1] || '', { breaks: true });
        }
        contentEl.style.opacity = 1;
      }, 250);

      const navEl = document.getElementById('page-navigation');
      const prevButton = navEl.querySelector('.prev-page');
      const nextButton = navEl.querySelector('.next-page');
      const indicator = navEl.querySelector('.page-indicator');

      prevButton.disabled = state.currentPage === 1;
      nextButton.disabled = state.currentPage > state.totalPages;
      indicator.textContent = state.currentPage > state.totalPages ? 'The End' : `Page ${state.currentPage} / ${state.totalPages}`;

      const mainContentEl = document.getElementById('main-content-area');
      if (mainContentEl) {
        mainContentEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      updateProgressBar();
      createSEOTags();
    }

    function attachPageNavListeners() {
      const prev = document.querySelector('.prev-page');
      const next = document.querySelector('.next-page');
      if (prev) prev.addEventListener('click', () => renderPage(state.currentPage - 1));
      if (next) next.addEventListener('click', () => renderPage(state.currentPage + 1));
    }

    function beginReading() {
      const mainContent = document.getElementById('main-content-area');
      if (mainContent) {
        mainContent.classList.add('visible');
        mainContent.style.display = 'grid';
        mainContent.scrollIntoView({ behavior: 'smooth', block: 'start' });
        setTimeout(() => {
          renderPage(state.currentPage);
          attachPageNavListeners();
        }, 500);
      }
    }

    let disqusLoaded = false;
    function loadDisqus(postIdentifier) {
      const container = document.getElementById('disqus_thread');
      if (!postIdentifier || !container || disqusLoaded) return;
      disqusLoaded = true;
      var disqus_config = function () {
        this.page.url = window.location.href;
        this.page.identifier = postIdentifier;
      };
      (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://bolus-personal-blog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    }

    function displayRelatedPosts(currentPost) {
      if (!state.allPosts.length || !currentPost || !currentPost.type) return;
      const container = document.getElementById('related-posts-container');
      if (!container) return;
      const related = state.allPosts.filter(p => p.type === currentPost.type && p.file !== currentPost.file && p.title && p.excerpt);
      if (related.length === 0) return;
      const shuffled = related.sort(() => 0.5 - Math.random());
      const selected = shuffled.slice(0, 3);
      const cardsHTML = selected.map(post => {
        const excerpt = (post.excerpt || 'Explore this related post').substring(0, 80) + '...';
        const title = post.title || 'Untitled Post';
        const coverHTML = post.cover ? `<div class="cover"><img src="${post.cover}" alt="${title}" loading="lazy"></div>` : `<div class="cover placeholder">No Image</div>`;
        return `<a href="post.html?file=${encodeURIComponent(post.file)}" class="related-post-card">${coverHTML}<div class="content"><h4>${title}</h4><p>${excerpt}</p></div></a>`;
      }).join('');
      container.innerHTML = `<h3 class="related-posts-title">You Might Also Like</h3><div class="related-posts-grid">${cardsHTML}</div>`;
    }

    function updateProgressBar() {
      if (!progressBar) return;
      if (state.mode === 'simple') {
        const { scrollTop, scrollHeight, clientHeight } = document.documentElement;
        const scrollableHeight = scrollHeight - clientHeight;
        progressBar.style.width = scrollableHeight > 0 ? `${(scrollTop / scrollableHeight) * 100}%` : '0%';
      } else {
        const progress = state.totalPages > 0 ? (state.currentPage / (state.totalPages + 1)) * 100 : 0;
        progressBar.style.width = `${progress}%`;
      }
    }

    function createTOC() {
      const headings = document.querySelectorAll('.post-content h2, .post-content h3');
      const tocContainer = document.querySelector('.toc-sidebar');
      if (headings.length < 2 || !tocContainer) return;

      tocContainer.innerHTML = '<h3>Contents</h3><ul></ul>';
      const tocList = tocContainer.querySelector('ul');

      headings.forEach(heading => {
        const id = heading.textContent.trim().toLowerCase().replace(/\s+/g, '-').replace(/[^\w-]+/g, '');
        heading.id = id;
        const li = document.createElement('li');
        li.innerHTML = `<a href="#${id}">${heading.textContent}</a>`;
        tocList.appendChild(li);
      });
    }

    function setupTOCObserver() {
      const headings = document.querySelectorAll('.post-content h2, .post-content h3');
      const tocLinks = document.querySelectorAll('.toc-sidebar a');
      if (headings.length < 2 || tocLinks.length < 2) return;

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          const id = entry.target.getAttribute('id');
          const tocLink = document.querySelector(`.toc-sidebar a[href="#${id}"]`);
          if (entry.isIntersecting && tocLink) {
            tocLinks.forEach(link => link.parentElement.classList.remove('active'));
            tocLink.parentElement.classList.add('active');
          }
        });
      }, { rootMargin: '-20% 0px -70% 0px' });
      headings.forEach(heading => observer.observe(heading));
    }

    function closeMenu() {
      sideMenu.classList.remove('active');
      menuOverlay.classList.remove('show');
      menuBtn.setAttribute('aria-expanded', 'false');
    }
    function openMenu() {
      sideMenu.classList.add('active');
      menuOverlay.classList.add('show');
      menuBtn.setAttribute('aria-expanded', 'true');
    }
    menuBtn.addEventListener('click', () => sideMenu.classList.contains('active') ? closeMenu() : openMenu());
    menuOverlay.addEventListener('click', closeMenu);
    window.addEventListener('scroll', updateProgressBar);

    document.addEventListener('DOMContentLoaded', loadPost);
  })();
  </script>
</body>
</html>
