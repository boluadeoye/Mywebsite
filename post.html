<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Post • Boluadeoye</title>

  <style>
    /* === Theme (your current colors) === */
    :root{
      --bg:#0f172a;         /* page background */
      --panel:#111a2e;      /* cards/header surface */
      --ink:#e5eefc;        /* main text */
      --muted:#a7b3cc;      /* secondary text */
      --orange:#f59e0b;     /* accent/CTA */
      --orange-ink:#0b0f19; /* text on orange */
      --ring:rgba(245,158,11,.25);
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--ink);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      line-height:1.6;
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:920px;margin:0 auto;padding:1.25rem}
    header{
      position:sticky; top:0; z-index:5;
      background:var(--panel);
      border-bottom:1px solid rgba(255,255,255,.05);
    }
    .brand{display:flex;align-items:center;gap:.75rem;padding:.75rem 0}
    .brand img{width:40px;height:40px;border-radius:50%;object-fit:cover}
    .brand h1{font-size:1.15rem;margin:0}

    .back{
      display:inline-flex; align-items:center; gap:.5rem;
      color:#fbbf24; font-weight:600; margin:.5rem 0 1rem 0;
    }

    .card{
      background:var(--panel);
      border-radius:var(--radius);
      padding:1.25rem;
      box-shadow:0 8px 24px rgba(0,0,0,.25)
    }
    .post h1{font-size:clamp(2rem,6vw,3.25rem);line-height:1.1;margin:.25rem 0 1rem}
    .post .meta{color:var(--muted);font-size:.95rem;margin-bottom:1rem}
    blockquote{
      margin:1rem 0; padding:1rem 1.25rem;
      border-left:6px solid var(--orange);
      background:rgba(255,255,255,.03); border-radius:12px;
    }
    .cta{
      display:inline-flex;align-items:center;gap:.5rem;
      background:var(--orange); color:var(--orange-ink);
      padding:.9rem 1.15rem; border-radius:14px; font-weight:700;
      box-shadow:0 12px 40px var(--ring);
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <a class="brand" href="./">
        <img src="images/bolu.jpg" alt="Boluadeoye" />
        <h1>Boluadeoye</h1>
      </a>
    </div>
  </header>

  <main class="wrap">
    <a class="back" href="./">← Back to writings</a>

    <!-- Where the fetched article will be injected -->
    <article id="postContainer" class="card post">
      <p style="color:var(--muted);">Loading…</p>
    </article>
  </main>

  <script>
  (async function () {
    // 1) get ?file=… from the url
    const params = new URLSearchParams(location.search);
    const file = params.get('file');

    const container = document.getElementById('postContainer');

    if (!file) {
      container.innerHTML = "<p style='color:#fbbf24'>No post specified.</p>";
      return;
    }

    try {
      // 2) fetch the HTML of the post file (same-origin file in /posts/…)
      const res = await fetch(file, { cache: 'no-store' });
      if (!res.ok) throw new Error(res.status + ' ' + res.statusText);
      const html = await res.text();

      // 3) parse and extract the main content safely
      const doc = new DOMParser().parseFromString(html, 'text/html');

      // Prefer an <article>, then <main>, else fall back to <body>
      const pick = doc.querySelector('article') ||
                   doc.querySelector('main') ||
                   doc.body;

      // Pull out title and meta if present
      const h1 = pick.querySelector('h1');
      if (h1) document.title = h1.textContent.trim() + " • Boluadeoye";

      // 4) inject into the card
      container.innerHTML = pick.innerHTML;

      // 5) make sure internal links work from nested content
      // (turn relative links inside the post into absolute relative to root)
      container.querySelectorAll('a[href]').forEach(a=>{
        const href = a.getAttribute('href');
        if (href && !href.startsWith('http') && !href.startsWith('#') && !href.startsWith('mailto:') && !href.startsWith('https://wa.me')) {
          // keep them root-relative
          a.setAttribute('href', href.replace(/^\.\//,'/'));
        }
      });

    } catch (err) {
      console.error(err);
      container.innerHTML = "<p style='color:#fbbf24'>Couldn't load this post. (" +
                            String(err.message) + ")</p>";
    }
  })();
  </script>
</body>
</html>
