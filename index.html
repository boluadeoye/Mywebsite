<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Boluadeoye ‚Äî Writings</title>
  <link rel="stylesheet" href="/assets/styles.css">
</head>
<body>
  <!-- Side Menu -->
  <nav id="sideMenu" class="side-menu">
    <a href="#" data-filter="all" class="filter-link active">All Writings</a>
    <a href="#" data-filter="poems" class="filter-link">Poems</a>
    <a href="#" data-filter="stories" class="filter-link">Stories</a>
    <a href="#" data-filter="faith" class="filter-link">Faith</a>
    <a href="#" data-filter="devotional" class="filter-link">Devotional</a>
    <a href="#" data-filter="articles" class="filter-link">Articles</a>
    <a href="#" data-filter="essays" class="filter-link">Essays</a>
    <a href="./about.html">About</a>
  </nav>
  <div id="menuOverlay" class="overlay"></div>

  <!-- Header -->
  <header>
    <div class="wrap header-row">
      <button id="menuBtn" class="hamburger" aria-label="Open menu">
        <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <rect x="4" y="6" width="16" height="2" rx="1"/>
          <rect x="4" y="11" width="16" height="2" rx="1"/>
          <rect x="4" y="16" width="16" height="2" rx="1"/>
        </svg>
      </button>
      <a class="brand" href="./">
        <span class="dot" aria-hidden="true"></span>
        <h1>Boluadeoye</h1>
      </a>
      <div class="search-container">
        <div class="search-bar">
          <input type="text" id="searchInput" placeholder="Search writings..." autocomplete="off" aria-label="Search writings">
          <span class="search-icon">üîç</span>
          <div id="searchResults" class="search-results" role="listbox"></div>
        </div>
      </div>
      <nav class="top-nav" aria-label="Filters">
        <a href="#" data-filter="all" class="filter-link active">All</a>
        <a href="#" data-filter="poems" class="filter-link">Poems</a>
        <a href="#" data-filter="stories" class="filter-link">Stories</a>
        <a href="#" data-filter="faith" class="filter-link">Faith</a>
        <a href="#" data-filter="devotional" class="filter-link">Devotional</a>
        <a href="#" data-filter="articles" class="filter-link">Articles</a>
        <a href="#" data-filter="essays" class="filter-link">Essays</a>
        <a href="./about.html">About</a>
      </nav>
    </div>
  </header>

  <!-- Main -->
  <main class="wrap">
    <section class="hero" aria-label="Intro">
      <div class="hero-split">
        <figure class="hero-photo">
          <img src="/images/bolu.jpg" alt="Boluadeoye">
        </figure>
        <div class="hero-copy">
          <span class="chip">‚ú® Personal Blog</span>
          <h2><span class="accent">Words that inspire</span> hearts and minds.</h2>
          <p class="sub">Exploring faith, life, and creativity through thoughtful writings and reflections that linger long after reading.</p>
          <a class="btn" href="#latest"><span>Explore Latest ‚Üí</span></a>
        </div>
      </div>
    </section>

    <div class="section-header">
      <h3 id="latest" class="section-title">Latest Writings</h3>
      <a href="./posts.html" class="view-all-link">View All <span>‚Üí</span></a>
    </div>

    <section id="posts" aria-live="polite">
      <div class="loading">
        <div class="loading-spinner"></div>
        <p>Loading posts...</p>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <div class="wrap">
      <p>¬© 2025 Boluadeoye ‚Ä¢ Crafted with passion</p>
    </div>
  </footer>

  <script src="/assets/scripts.js"></script>
  <script>
    let allPosts = [];
    let currentFilter = 'all';
    const postsEl = document.getElementById('posts');
    const searchInput = document.getElementById('searchInput');
    const searchResults = document.getElementById('searchResults');

    async function loadPosts() {
      try {
        const res = await fetch('/Posts.json', { cache: 'no-store' });
        if (!res.ok) throw new Error(`Failed to load Posts.json (Status: ${res.status})`);
        const data = await res.json();
        if (!Array.isArray(data)) throw new Error('Posts.json must be an array');
        allPosts = data.map(p => ({
          ...p,
          type: (p.type || '').toLowerCase()
        })).sort((a, b) => String(b.date).localeCompare(String(a.date)));
        filterPosts(currentFilter);
        postsEl.classList.add('loaded');
      } catch (err) {
        console.error('Error loading posts:', err);
        postsEl.innerHTML = `
          <div style="text-align:center;padding:3rem;color:var(--muted);">
            <h3>No posts available</h3>
            <p>Check back soon for new writings!</p>
          </div>`;
      }
    }

    function filterPosts(filter) {
      currentFilter = filter;
      document.querySelectorAll('.filter-link').forEach(link => {
        link.classList.toggle('active', link.getAttribute('data-filter') === filter);
      });
      let list = allPosts.slice();
      if (filter !== 'all') list = list.filter(p => p.type === filter);
      displayPosts(list.slice(0, 3));
    }

    function displayPosts(list) {
      if (!list || !list.length) {
        postsEl.innerHTML = `<p style="text-align:center;color:var(--muted);padding:3rem;">No ${currentFilter === 'all' ? '' : ' ' + currentFilter} posts available.</p>`;
        return;
      }
      postsEl.innerHTML = list.map(p => `
        <article class="post">
          <div class="post-header">
            <div>
              <h3><a href="post.html?file=${encodeURIComponent(p.file)}" style="color:inherit;">${p.title}</a></h3>
              <div class="post-date">üìÖ ${new Date(p.date).toLocaleDateString('en-US', {year:'numeric',month:'short',day:'numeric'})}</div>
            </div>
            <span class="post-type">${p.type || 'reflection'}</span>
          </div>
          <p>${p.excerpt || ''}</p>
          <div class="stats">
            <span class="stat-item">‚ù§Ô∏è Liked</span>
            <span class="stat-item">üëÅÔ∏è Viewed</span>
          </div>
        </article>
      `).join('');
    }

    document.querySelectorAll('.filter-link').forEach(link => {
      link.addEventListener('click', e => {
        e.preventDefault();
        const filter = link.getAttribute('data-filter');
        if (filter) {
          filterPosts(filter.toLowerCase());
          closeMenu();
          document.getElementById('latest').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });
    });

    let searchTimeout;
    if (searchInput) {
      searchInput.addEventListener('input', e => {
        clearTimeout(searchTimeout);
        const q = e.target.value.trim();
        if (q.length < 2) { searchResults.classList.remove('active'); return; }
        searchTimeout = setTimeout(() => {
          const t = q.toLowerCase();
          const results = allPosts.filter(post =>
            (post.title || '').toLowerCase().includes(t) ||
            (post.excerpt || '').toLowerCase().includes(t) ||
            (post.type || '').toLowerCase().includes(t)
          );
          searchResults.innerHTML = results.length ?
            results.slice(0, 5).map(p => `
              <a href="post.html?file=${encodeURIComponent(p.file)}" class="search-result-item">
                <div class="search-result-title">${p.title}</div>
                <div class="search-result-excerpt">${(p.excerpt || '').slice(0, 80)}...</div>
              </a>`).join('')
            :
            `<div class="search-result-item">
               <div class="search-result-title">No results found</div>
               <div class="search-result-excerpt">Try different keywords</div>
             </div>`;
          searchResults.classList.add('active');
        }, 300);
      });
    }

    document.addEventListener('click', e => {
      if (!e.target.closest('.search-container')) searchResults.classList.remove('active');
      if (e.target.closest('.search-result-item')) searchResults.classList.remove('active');
    });

    document.addEventListener('DOMContentLoaded', loadPosts);
  </script>
</body>
</html>
